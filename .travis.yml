language: python
services:
  - docker

before_install:
  docker build -t markusressel/telegram-click .
python:
  - '3.5'
  - '3.6'
  - '3.7'
  - '3.8'
install:
  - pip install --upgrade pip
  - pip install pipenv
  - pipenv install --system --deploy
  - pip install --no-cache-dir .
script:
  - nosetests
deploy:
  - provider: script
    skip_cleanup: true
    script: bash travis/docker_push
    on:
      branch: master
      tags: true
      python: 3.8
  - provider: script
    skip_cleanup: true
    script: bash travis/docker_push_latest
    on:
      branch: master
      tags: false
      python: 3.8